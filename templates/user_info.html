<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/css/user_info.css">
    <title>Virtual Wallet Dashboard - {{ user.username }}</title>
</head>

<body>
    <div class="dashboard-container">
        <!-- Header Section -->
        <div class="header">
            <img src="{{ user.avatar_url or '/static/images/default_user_avatar.png' }}" alt="Avatar" class="avatar">

            <div class="user-summary">
                <h1>{{ user.username }}</h1>
                <p>{{ user.email }}</p>
                {% if user.phone_number %}
                <p>{{ user.phone_number }}</p>
                {% endif %}
                <div class="status-badges">
                    {% if user.is_admin %}
                    <span class="badge admin">Admin</span>
                    {% endif %}
                    {% if user.is_verified %}
                    <span class="badge verified">Verified</span>
                    {% endif %}
                    {% if not user.is_blocked %}
                    <span class="badge active">Active</span>
                    {% endif %}
                </div>
            </div>

            <div class="balance-card">
                <div class="balance-amount">{{ "%.2f"|format(user.balance) }}</div>
                <div class="balance-currency">{{ user.currency_code }}</div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Account Information -->
            <div class="info-card">
                <h2 class="card-title">Account Information</h2>
                <div class="info-row">
                    <span class="info-label">User ID</span>
                    <span class="info-value">#{{ user.id }}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Username</span>
                    <span class="info-value">{{ user.username }}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Email</span>
                    <span class="info-value">{{ user.email }}</span>
                </div>
                {% if user.phone_number %}
                <div class="info-row">
                    <span class="info-label">Phone</span>
                    <span class="info-value">{{ user.phone_number }}</span>
                </div>
                {% endif %}
                <div class="info-row">
                    <span class="info-label">Currency</span>
                    <span class="info-value">{{ user.currency_code }}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Member Since</span>
                    <span class="info-value created-date">{{ user.created_at }}</span>
                </div>
            </div>

            <!-- Payment Cards -->
            <div class="info-card">
                <h2 class="card-title">Payment Cards ({{ cards|length }})</h2>
                {% if cards %}
                <div class="cards-container">
                    {% for card in cards %}
                    <a href="/users/bankcards/{{ card.id }}" class="card-link">
                        <div class="card-item {% if card.image_url %}has-image{% endif %}" {% if card.image_url
                            %}style="background-image: url('{{ card.image_url }}')" {% endif %}>
                            <div class="card-overlay"></div>
                            <div class="card-header">
                                <div>
                                    <div class="card-nickname">{{ card.nickname or 'Card #' + card.id|string }}</div>
                                </div>
                                <span class="card-type {{ card.type.lower() }}">{{ card.type }}</span>
                            </div>
                            <div class="card-body">
                                {% if not card.image_url %}
                                <div class="card-pattern"></div>
                                {% endif %}
                            </div>
                        </div>
                    </a>
                    {% endfor %}
                </div>
                {% else %}
                <p style="color: #666; text-align: center; padding: 20px;">No payment cards found</p>
                {% endif %}
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="actions-grid">
            <a href="/users/contacts" class="action-btn">
                <div class="action-icon">👥</div>
                <div class="action-content">
                    <h3>View Contacts</h3>
                    <p>Manage your saved contacts and recipients</p>
                </div>
            </a>

            <a href="/users/transactions" class="action-btn">
                <div class="action-icon">📊</div>
                <div class="action-content">
                    <h3>View Transactions</h3>
                    <p>Check your transaction history and details</p>
                </div>
            </a>

            <a href="/users/transactions/new" class="action-btn">
                <div class="action-icon">💸</div>
                <div class="action-content">
                    <h3>New Transaction</h3>
                    <p>Send money or make a payment</p>
                </div>
            </a>

            <a href="/users/bankcards/new" class="action-btn">
                <div class="action-icon">🏦</div>
                <div class="action-content">
                    <h3>New Bank Card</h3>
                    <p>Add a new bank card to your wallet</p>
                </div>
            </a>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Add smooth scroll behavior for any internal links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth'
                        });
                    }
                });
            });

            // Add loading states for action buttons
            document.querySelectorAll('.action-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    this.style.opacity = '0.7';
                    this.style.pointerEvents = 'none';

                    // Reset after 2 seconds in case navigation fails
                    setTimeout(() => {
                        this.style.opacity = '1';
                        this.style.pointerEvents = 'auto';
                    }, 2000);
                });
            });

            // Format phone number display if needed
            const phoneElements = document.querySelectorAll('.info-value');
            phoneElements.forEach(el => {
                if (el.textContent.match(/^\+\d+$/)) {
                    // Already formatted, no action needed
                }
            });
        });
    </script>
</body>

</html>